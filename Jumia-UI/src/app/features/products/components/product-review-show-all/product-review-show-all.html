<div class="container">
  <div class="reviews-container" *ngIf="reviews.length > 0">
    
    <div class="header-section">
      <div class="d-flex justify-content-between align-items-center">
        <div class="reviews-title">Verified Customer Reviews</div>
      </div>
      <div class="verified-badge">
        <i class="fas fa-check-circle"></i>
        Verified Purchase
      </div>
    </div>

    <div class="rating-overview">
      <div class="rating-left">
        <div class="comment-label">Product Comments ({{ reviews.length }})</div>
        <div class="stars">
          <ng-container *ngFor="let _ of getStars(averageRating)">
            <i class="fas fa-star"></i>
          </ng-container>
        </div>
        <div class="quality-section">
          <div class="quality-label">Quality</div>
          <div class="quality-value">Good</div>
        </div>
      </div>

      <div class="rating-right">
        <div class="main-rating">
          {{ averageRating | number: '1.1-1' }}<span style="font-size: 20px; color: #666;">/5</span>
        </div>
        <div class="stars">
          <ng-container *ngFor="let _ of getStars(averageRating)">
            <i class="fas fa-star"></i>
          </ng-container>
        </div>
        <div class="total-reviews">{{ reviews.length }} Verified Product Ratings</div>
      </div>
    </div>

    <div class="text-end my-3" *ngIf="canAddReview && !showReviewForm">
      <button class="btn btn-primary" (click)="showReviewForm = true">Add Review</button>
    </div>

    <div *ngIf="showReviewForm" class="card p-4 shadow-sm mb-4" style="max-width: 600px; margin: 0 auto;">
      <h5 class="mb-3">Add Your Review</h5>
      
      <div class="mb-3">
        <label class="form-label">Rating (1-5):</label>
        <input type="number" [(ngModel)]="newReview.stars" min="1" max="5" class="form-control" />
      </div>
      
      <div class="mb-3">
        <label class="form-label">Comment:</label>
        <textarea [(ngModel)]="newReview.comment" class="form-control" rows="4"></textarea>
      </div>
      
      <div class="d-flex justify-content-end">
        <button class="btn btn-secondary me-2" (click)="showReviewForm = false">Cancel</button>
        <button class="btn btn-success" (click)="submitReview()">Submit</button>
      </div>
    </div>

    <div class="customer-review" *ngFor="let review of paginatedReviews">
      <div class="review-header d-flex justify-content-between">
        <div class="reviewer-name">By {{ review.customerName }}</div>
        <div class="review-date">{{ review.createdAt | date }}</div>
      </div>
      <div class="review-stars text-warning">
        <ng-container *ngFor="let _ of getStars(review.stars)">
          <i class="fas fa-star"></i>
        </ng-container>
      </div>
      <div class="review-comment mt-2">{{ review.comment }}</div>
    </div>

    <nav *ngIf="totalPages > 1" class="mt-4" aria-label="Pagination">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="goToPage(currentPage - 1)">Previous</button>
        </li>

        <li class="page-item" 
            *ngFor="let page of [].constructor(totalPages); let i = index"
            [class.active]="currentPage === i + 1">
          <button class="page-link" (click)="goToPage(i + 1)">{{ i + 1 }}</button>
        </li>

        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="goToPage(currentPage + 1)">Next</button>
        </li>
      </ul>
    </nav>
  </div>

  <div *ngIf="reviews.length === 0" class="text-center p-4">
    <p>No reviews yet. Be the first to review!</p>
    <div *ngIf="canAddReview && !showReviewForm">
      <button class="btn btn-primary" (click)="showReviewForm = true">Add Review</button>
    </div>
  </div>
</div>
