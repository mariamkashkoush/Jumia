<div class="products">
  <div class="page-header">
    <div class="header-content">
      <h2><i class="fas fa-boxes"></i> Products Management</h2>
      <p>Manage your product inventory and listings</p>
    </div>
    <button class="btn-primary" (click)="navigateToAddProduct()">
      <i class="fas fa-plus"></i> Add New Product
    </button>
  </div>

  <div class="products-controls">
    <div class="search-box">
      <input
        type="text"
        placeholder="Search products..."
        [(ngModel)]="searchTerm"
        (input)="searchProducts()">
    </div>

    <div class="filter-group">
      <select [(ngModel)]="selectedStatus" (change)="filterProducts()">
        <option value="all"><i class="fas fa-list"></i> All Status</option>
        <option value="pending"><i class="fas fa-clock"></i> Pending</option>
        <option value="approved"><i class="fas fa-check"></i> Approved</option>
        <option value="rejected"><i class="fas fa-times"></i> Rejected</option>
      </select>
    </div>
  </div>

  <div class="products-stats">
    <div class="stat-item">
      <div class="stat-icon">
        <i class="fas fa-boxes"></i>
      </div>
      <div class="stat-content">
        <span class="stat-number">{{products?.length}}</span>
        <span class="stat-label">Total Products</span>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-icon">
        <i class="fas fa-clock"></i>
      </div>
      <div class="stat-content">
        <span class="stat-number">{{pending?.length}}</span>
        <span class="stat-label">Pending</span>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-content">
        <span class="stat-number">{{approved?.length}}</span>
        <span class="stat-label">Approved</span>
      </div>
    </div>
    <div class="stat-item">
      <div class="stat-icon">
        <i class="fas fa-times-circle"></i>
      </div>
      <div class="stat-content">
        <span class="stat-number">{{rejected?.length}}</span>
        <span class="stat-label">Rejected</span>
      </div>
    </div>
  </div>

  <div class="products-grid" *ngIf="filteredProducts.length > 0">
    <div class="product-card" *ngFor="let product of paginatedProducts">
      <div class="product-image">
        <img [src]="baseImageUrl + product.imageUrl" [alt]="product.name">
        <div class="product-status">
          <span class="status-badge" [class]="getStatusClass(product.approvalStatus)">
            <i class="fas fa-info-circle"></i> {{product.approvalStatus | titlecase}}
          </span>
        </div>
      </div>

      <div class="product-content">
        <h3><i class="fas fa-tag"></i> {{product.name}}</h3>

        <div class="product-details">
          <span class="product-price">
           EGP{{product.basePrice | number:'1.2-2'}}
          </span>
          <span class="product-stock">
            <i class="fas fa-warehouse"></i> Stock: {{product.stockQuantity > 0 ? product.stockQuantity : "Out of Stock"}}
          </span>
        </div>

        <div class="product-actions">
          <button class="btn-edit" (click)="editProduct(product.productId)">
            <i class="fas fa-edit"></i> Edit Product
          </button>
          <button
            *ngIf="product.isAvailable === false && product.stockQuantity > 0"
            class="btn-toggle active"
            (click)="activateproduct(product.productId)">
            <i class="fas fa-play"></i> Activate
          </button>
          <button
            *ngIf="product.isAvailable === true"
            class="btn-delete"
            (click)="deleteProduct(product.productId)">
            <i class="fas fa-trash-alt"></i> Delete Product
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="filteredProducts.length === 0" class="no-products">
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-box-open"></i>
      </div>
      <h3><i class="fas fa-exclamation-triangle"></i> No Products Found</h3>
      <p>Try adjusting your search criteria or add a new product to get started.</p>
      <button class="btn-primary" (click)="navigateToAddProduct()">
        <i class="fas fa-plus-circle"></i> Add Your First Product
      </button>
    </div>
  </div>

  <!-- Enhanced Pagination Controls -->
  <div class="pagination-controls" *ngIf="filteredProducts.length > itemsPerPage">
    <button
      (click)="prevPage()"
      [disabled]="currentPage === 1"
      class="pagination-button">
      <i class="fas fa-chevron-left"></i> Previous
    </button>

    <ng-container *ngFor="let page of pageNumbers">
      <span
        *ngIf="page === 1 && pageNumbers[0] !== 1"
        (click)="goToPage(1)"
        class="page-number">
        1
      </span>
      <span
        *ngIf="page === 1 && pageNumbers[0] > 2"
        class="page-ellipsis">
        <i class="fas fa-ellipsis-h"></i>
      </span>
      <span
        (click)="goToPage(page)"
        [class.active]="page === currentPage"
        class="page-number">
        {{ page }}
      </span>
      <span
        *ngIf="page === pageNumbers[pageNumbers.length - 1] && page < totalPages - 1"
        class="page-ellipsis">
        <i class="fas fa-ellipsis-h"></i>
      </span>
      <span
        *ngIf="page === pageNumbers[pageNumbers.length - 1] && page < totalPages"
        (click)="goToPage(totalPages)"
        class="page-number">
        {{ totalPages }}
      </span>
    </ng-container>

    <button
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
      class="pagination-button">
      Next <i class="fas fa-chevron-right"></i>
    </button>

    <span class="page-info">
      <i class="fas fa-info-circle"></i> Page {{ currentPage }} of {{ totalPages }} ({{ filteredProducts.length }} products)
    </span>
  </div>
</div>
