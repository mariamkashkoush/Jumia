<div class="products-container">
  <div class="header">
    <h2>Products Management</h2>

  </div>

  <!-- Loading and Error States -->
  <div *ngIf="isLoading" class="loading-state">
    <p>Loading products...</p>
  </div>

  <div *ngIf="error" class="error-state">
    <p class="error-message">{{error}}</p>
    <button class="btn btn-secondary" (click)="loadProducts()">Retry</button>
  </div>

  <!-- Search and Filters -->
  <div *ngIf="!isLoading && !error" class="search-filter">
    <input type="text" placeholder="Search products..." [(ngModel)]="searchTerm" class="search-input">
    <!-- Add other filters as needed -->

    <div class="status-filter">
      <label>Filter by Status:</label>
      <select [(ngModel)]="statusFilter" class="filter-select">
        <option value="">All Statuses</option>
        <option value="Pending">Pending</option>
        <option value="Approved">Approved</option>
        <option value="Rejected">Rejected</option>
      </select>
    </div>

  </div>

  <!-- Products Grid -->
  <div class="products-grid">
    <div *ngIf="isLoading" class="loading-state">
      <p>Loading products...</p>
    </div>

    <div *ngIf="error" class="error-state">
      <p class="error-message">{{error}}</p>
      <button class="btn btn-secondary" (click)="loadProducts()">Retry</button>
    </div>

    <ng-container *ngIf="!isLoading && !error">
      <div *ngIf="filteredProducts.length === 0" class="no-results">
        <p>No products found matching your criteria.</p>
      </div>




        
      <div class="product-card" *ngFor="let product of paginatedProducts">
        <div class="product-image">
          <img [src]=" baseImageUrl+ product.imageUrl || ''" [alt]="product.name" (error)="handleImageError($event)">

        </div>
        <div class="product-info">
          <h4>{{product.name}}</h4>
          <p class="price">
            ${{product.basePrice}}
            <span *ngIf="product.discountPercentage" class="discount">
              ({{product.discountPercentage}} off)
            </span>
          </p>

          <div *ngFor="let variant of product.variants" class="variant-info">
            <p>
              {{variant.color}} / {{variant.size}} -
              ${{variant.price}} -
              Stock: {{variant.stock}} -
              <span class="status" [class]="variant.status.toLowerCase()">
                {{variant.status}}
              </span>
            </p>
          </div>
        </div>
        <div class="product-actions">
          <!-- Accept Button (only shows for pending products) -->
          <button class="btn btn-sm btn-success" (click)="acceptProduct(product)"
            *ngIf="product.approvalStatus === 'pending'">
            Accept
          </button>

          <!-- Decline Button (only shows for pending products) -->
          <button class="btn btn-sm btn-warning" (click)="declineProduct(product)"
            *ngIf="product.approvalStatus === 'pending'">
            Decline
          </button>

          <!-- Delete Button (shows for all products) -->
          <button class="btn btn-sm btn-danger" (click)="deleteProduct(product)">
            Delete
          </button>

          <!-- Status Badge -->
          <span class="status-badge" [class.pending]="product.approvalStatus === 'pending'"
            [class.approved]="product.approvalStatus === 'approved'"
            [class.rejected]="product.approvalStatus === 'rejected'">
            {{product.approvalStatus}}
          </span>

          <!-- Availability Badge -->
          <span class="availability-badge" [class.available]="product.isAvailable">
            {{product.isAvailable ? 'Available' : 'Unavailable'}}
          </span>
        </div>


      </div>
    </ng-container>
  </div>
</div>
    <!-- Pagination Controls -->
<div class="pagination-controls" *ngIf="filteredProducts!.length > itemsPerPage">
  <button
    (click)="prevPage()"
    [disabled]="currentPage === 1"
    class="pagination-button">
    Previous
  </button>

  <ng-container *ngFor="let page of pageNumbers">
    <span
      *ngIf="page === 1 && pageNumbers[0] !== 1"
      (click)="goToPage(1)"
      class="page-number">
      1
    </span>
    <span
      *ngIf="page === 1 && pageNumbers[0] > 2"
      class="page-ellipsis">
      ...
    </span>
    <span
      (click)="goToPage(page)"
      [class.active]="page === currentPage"
      class="page-number">
      {{ page }}
    </span>
    <span
      *ngIf="page === pageNumbers[pageNumbers.length - 1] && page < totalPages - 1"
      class="page-ellipsis">
      ...
    </span>
    <span
      *ngIf="page === pageNumbers[pageNumbers.length - 1] && page < totalPages"
      (click)="goToPage(totalPages)"
      class="page-number">
      {{ totalPages }}
    </span>
  </ng-container>

  <button
    (click)="nextPage()"
    [disabled]="currentPage === totalPages"
    class="pagination-button">
    Next
  </button>

  <span class="page-info">
    Page {{ currentPage }} of {{ totalPages }} ({{ filteredProducts?.length }} items)
  </span>
</div>